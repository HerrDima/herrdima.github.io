"use strict";(self.webpackChunktypescript_project=self.webpackChunktypescript_project||[]).push([[225],{7687:(e,t,i)=>{i.d(t,{x:()=>r});var n=i(5893);function a(e){if("number"==typeof e)return[e,e,e,e];if(!Array.isArray(e))return[0,0,0,0];switch(e.length){case 0:return[0,0,0,0];case 1:return[e[0],e[0],e[0],e[0]];case 2:return[e[0],e[1],e[0],e[1]];case 3:return[e[0],e[1],e[2],e[1]];case 4:return[e[0],e[1],e[2],e[3]];default:return console.error("makeCssArray: too big array"),[e[0],e[1],e[2],e[3]]}}function r(e){const{tagName:t="div",children:i,margin:r,padding:s,width:l,height:o,boxSizing:d,backgroundColor:c,display:u}=e,[m,h,f,p,x,j,g,Z]=[...a(r),...a(s)].map((e=>`${e}px`)),b={backgroundColor:c,boxSizing:d,display:u,height:o,marginBottom:f,marginLeft:p,marginRight:h,marginTop:m,paddingBottom:g,paddingLeft:Z,paddingRight:j,paddingTop:x,width:l};return(0,n.jsx)(t,{style:b,children:i})}},2780:(e,t,i)=>{var n;i.d(t,{$t:()=>l,VJ:()=>a,WY:()=>o,dW:()=>n,hd:()=>r,uN:()=>s}),function(e){e.create="create",e.edit="edit"}(n||(n={}));const a=["id","slug","subDocumentIdList","title"],r="0000-00-00T00:00:00.000Z",s="image/png, image/jpeg, image/gif, image/webp",l=16e6,o=75e6},2171:(e,t,i)=>{i.d(t,{D6:()=>g,cT:()=>f,j9:()=>j,kA:()=>b,o3:()=>p,sB:()=>x,v8:()=>Z});var n=i(4644),a=i(3685),r=i(4057),s=i(5181),l=i(6661),o=i(6479),d=i(6163),c=i(874),u=i(4756),m=i(6290),h=i(2780);async function f(e,t){const i=new FormData;if(e.size>=t)throw new Error(`Too big file, limit ${t/1e6}MB`);i.append("file",e);const n=await(0,l.w)(s.JW.adminFileUpload,(0,c.Dn)(),{body:i,credentials:"include",method:l.T.post}),a=(0,m.a)(n.name);switch(n.type){case d.iw.image:{const{naturalHeight:e,naturalWidth:t}=await function(e){const t=new Image;return new Promise(((i,n)=>{t.addEventListener("load",(()=>i(t)),!1),t.addEventListener("error",n,!1),t.src=e}))}(a);return{...n,height:e,width:t}}case d.iw.audio:{const{duration:e}=await function(e){const t=new Audio;return new Promise(((i,n)=>{t.addEventListener("loadedmetadata",(()=>i(t)),!1),t.addEventListener("error",n,!1),t.preload="metadata",t.src=e}))}(a);return{...n,duration:e}}case d.iw.video:{const{duration:e,videoWidth:t,videoHeight:i}=await function(e){const t=document.createElement("video");return new Promise(((i,n)=>{t.addEventListener("loadedmetadata",(()=>i(t)),!1),t.addEventListener("error",n,!1),t.preload="metadata",t.src=e}))}(a);return{...n,duration:e,height:i,width:t}}case d.iw.unknown:return n;default:throw new u.sF(n.type)}return n}function p(e){const{id:t,mode:i,savedArticleList:n}=e;return[{message:"Required!",required:!0},{message:"Please-enter-slug-properly.",validator:async(e,t)=>{if((0,a.Iu)(t)!==t)throw new Error("Slug is not formatted.")}},{message:"Please enter another slug. This slug already exists.",validator:async(e,a)=>{const r=n.filter((e=>e.slug===a)),s=r.length;if(0===s)return;if(s>=2)throw new Error("There are should be only one no non articles");const l=s>0;if(i===h.dW.create&&l)throw new Error("Use unique slug.");const[o]=r;if(i===h.dW.edit&&o.slug===a&&o.id!==t)throw new Error("Article with your slug already exists")}}]}function x(){return[{message:"Invalid HTML.",validator:async(e,t)=>{if("undefined"==typeof document)return;const i=document.createElement("div");if(i.innerHTML=t,i.innerHTML.trim()!==t.trim())throw new Error("HTML is not valid")}}]}function j(e){return(0,n.Gn)(r.$.articleEdit.path,{articleId:e})}function g(e){const t=function(e){return e.includes(".")?(e.split(".").pop()||"").toLowerCase():""}(e);return["jpg","jpeg","jfif","gif","png","webp"].includes(t)}function Z(e,t){return 0===t.length?[]:e.filter((e=>!t.some((t=>t.id===e))))}function b(e){return(0,o.jX)(e).then((()=>location.reload())).catch(console.error)}},6406:(e,t,i)=>{i.d(t,{d:()=>ne});var n=i(5893),a=i(7294),r=i(2124),s=i(9020),l=i(2787),o=i(3845),d=i(9477),c=i(6962),u=i(6775),m=i(5460),h=i(9676),f=i(1577),p=i(8917),x=i(9655),j=i(1870),g=i(2138),Z=i(7484),b=i.n(Z),L=i(178),y=i.n(L),I=i(6163),v=i(874),w=i(3685),T=i(4154),S=i(6479),k=i(1230),N=i(5746),A=i(7687),D=i(7474);function C(e){const{mdInput:t,children:i}=e;return(0,n.jsxs)(k.Z,{className:"d6389f",gutter:[16,0],children:[(0,n.jsx)(N.Z,{span:12,children:i}),(0,n.jsx)(N.Z,{span:12,children:(0,n.jsx)(A.x,{backgroundColor:"#fff",height:"calc(100% - 54px)",margin:[32,0,16],padding:[8],children:(0,n.jsx)(D.U,{articleTitle:"",mdInput:t})})})]})}var V=i(1681),$=i(3624),M=i(4564),R=i(5643),E=i(1636),F=i(7178),P=i(2171),U=i(9101),O=i(6290);const{Option:W}=s.Z,{Text:H}=r.Z;function B(e){const{name:t}=e;return{name:t,status:"done",uid:t,url:(0,P.D6)(t)?(0,O.s)(t,{height:96,width:96}):(0,O.a)(t)}}function z(e){const{title:t,id:i}=e;return(0,n.jsx)(W,{title:t,value:i,children:t},i)}function K(e,t){const{id:i}=e;return t.filter((e=>e.subDocumentIdList.includes(i)))}function q(e,t){const i=K(e,t).map(((e,t)=>{const{id:i,title:a,slug:r}=e;return(0,n.jsxs)(H,{children:[t>0?", ":null,(0,n.jsx)(x.Link,{to:(0,M._)(r),children:a})," | ",(0,n.jsx)(x.Link,{to:(0,P.j9)(i),children:r})]},i)}));return i.length>0?i:[(0,n.jsx)(H,{children:"no parents"},"no-parents")]}function J(){return(0,n.jsx)(f.Z,{icon:(0,n.jsx)(U.Z,{}),children:"Upload"})}var X=i(2780),Q=i(5769);const{Title:_}=r.Z;function G(e){const{setFileTitle:t,fileInfo:i,originNode:a,file:r}=e;return i?(0,n.jsxs)(A.x,{height:112,children:[a,(0,n.jsxs)(k.Z,{gutter:8,children:[(0,n.jsx)(N.Z,{span:12,children:(0,n.jsx)(l.Z,{defaultValue:i.title,onInput:e=>{t(e.currentTarget.value.trim())},placeholder:"Title"})}),(0,n.jsx)(N.Z,{span:12,children:(0,n.jsx)(l.Z,{readOnly:!0,value:(0,Q.B)(i,{alt:""})})})]})]}):(0,n.jsxs)(_,{level:4,type:"danger",children:["Can not found file by name: ",r.name]})}b().extend(y());const{Text:Y,Title:ee}=r.Z,{Option:te}=s.Z,{TextArea:ie}=l.Z;function ne(e){const{article:t,onFinish:i,mode:r}=e,{articleType:Z,content:L,createdDate:y,description:k,descriptionShort:N,fileList:D,hasMetaRobotsNoFollowSeo:U,hasMetaRobotsNoIndexSeo:O,id:W,isActive:H,isInSiteMapXmlSeo:Q,metaDescriptionSeo:_,metaKeyWordsSeo:ne,metaSeo:ae,publishDate:re,slug:se,staffArtistList:le,staffAuthorList:oe,staffCompositorList:de,staffDirectorList:ce,staffIllustratorList:ue,staffReaderList:me,subDocumentIdList:he,subDocumentListViewType:fe,tagList:pe,tagTitleSeo:xe,title:je,titleImage:ge,updatedDate:Ze}=t,[be]=o.Z.useForm(),[Le,ye]=(0,a.useState)([...D]),[Ie,ve]=(0,a.useState)(ge),[we,Te]=(0,a.useState)(re||(new Date).toISOString()),[Se,ke]=(0,a.useState)((0,w.Iu)(je)),[Ne,Ae]=(0,a.useState)(t),[De,Ce]=(0,a.useState)(!1);(0,R.K)([R.A.ctrl],"s",be.submit);const{execute:Ve}=(0,T.Od)(S.Qy),[$e,Me]=(0,a.useState)([]);(0,a.useEffect)((()=>{Ve({},{pageIndex:0,pageSize:0,sort:{title:1}},X.VJ).then((e=>Me(e.list))).catch((e=>{d.ZP.error("Can not fetch article list.")}))}),[Ve]);const Re=(0,P.v8)(he,$e),Ee=K(t,$e).length>0||W===$.Z;return(0,n.jsxs)(o.Z,{autoComplete:"off",form:be,initialValues:{remember:!0},layout:"vertical",name:"article",onFieldsChange:function(e,t){},onFinish:function(e){const t={...e,fileList:Le,publishDate:we,staffArtistList:(0,w.yk)(e.staffArtistList),staffAuthorList:(0,w.yk)(e.staffAuthorList),staffCompositorList:(0,w.yk)(e.staffCompositorList),staffDirectorList:(0,w.yk)(e.staffDirectorList),staffIllustratorList:(0,w.yk)(e.staffIllustratorList),staffReaderList:(0,w.yk)(e.staffReaderList),tagList:(0,w.yk)(e.tagList),title:(0,w.p9)(e.title),titleImage:Ie},[n,a]=(0,v.NA)(t);console.info("validateFunction.errors"),console.info(a.errors),n?i(t):d.ZP.error(JSON.stringify(a.errors))},onFinishFailed:function(e){d.ZP.error(JSON.stringify(e.errorFields))},onValuesChange:function(e,t){ke((0,w.Iu)(t.title)),Ae(t)},scrollToFirstError:!0,children:[(0,n.jsx)(F.$,{isShow:De,position:"fixed"}),(0,n.jsx)(V.K,{isRender:Re.length>0,children:(0,n.jsxs)(ee,{level:4,type:"danger",children:["Document has missing children, children Id: ",Re.join(", ")]})}),(0,n.jsx)(A.x,{padding:[8,0],children:(0,n.jsxs)(Y,{children:["Article: ",(0,n.jsx)(x.Link,{to:(0,M._)(se),children:je})," | ",(0,n.jsx)(x.Link,{to:(0,P.j9)(W),children:se})]})}),(0,n.jsx)(A.x,{padding:[8,0,16],children:(0,n.jsxs)(Y,{children:["Parents: ",q(t,$e)]})}),(0,n.jsx)(o.Z.Item,{hidden:!0,initialValue:W,label:`Article id: ${W}`,name:"id",children:(0,n.jsx)(l.Z,{disabled:!0})}),(0,n.jsx)(o.Z.Item,{label:`Title image (to 16MB): ${Ie.name}`,children:(0,n.jsx)(c.Z,{accept:X.uN,action:async e=>{try{Ce(!0);const t=await(0,P.cT)(e,X.$t);ve(t)}catch(e){const t=e instanceof Error?e.message:"Too big file";d.ZP.error(t)}finally{Ce(!1)}return"https://dev.null/dev/null"},fileList:Ie.size>0?[Ie].map(B):[],itemRender:(e,t)=>G({file:t,fileInfo:Ie,originNode:e,setFileTitle:e=>{ve({...Ie,title:e})}}),listType:"picture",maxCount:1,onChange:function(e){const{file:t}=e;"removed"===t.status&&ve((0,E.Q)())},children:Ie.size>0?null:(0,n.jsx)(J,{})})}),(0,n.jsx)(o.Z.Item,{initialValue:je,label:"Title:",name:"title",rules:[{message:"Required!",required:!0}],children:(0,n.jsx)(l.Z,{placeholder:"Title"})}),(0,n.jsx)(o.Z.Item,{initialValue:se,label:`Slug, avoid spec symbols, slug from title: ${Se}`,name:"slug",normalize:w.Iu,rules:(0,P.o3)({id:W,mode:r,savedArticleList:$e}),children:(0,n.jsx)(l.Z,{disabled:0===$e.length,placeholder:"slug-is-here"})}),(0,n.jsx)(o.Z.Item,{initialValue:Z,label:"Article type:",name:"articleType",children:(0,n.jsxs)(s.Z,{children:[(0,n.jsx)(te,{value:I.UL.article,children:"Article"}),(0,n.jsx)(te,{value:I.UL.container,children:"Container"}),(0,n.jsx)(te,{value:I.UL.audioList,children:"Audio List"}),(0,n.jsx)(te,{value:I.UL.audioSingle,children:"Audio Single"}),(0,n.jsx)(te,{value:I.UL.audioChildrenList,children:"Audio Children List"})]})}),(0,n.jsx)(o.Z.Item,{initialValue:(0,w.sj)(pe),label:`Tag List, use comma "," to divide: ${(0,w.pi)(Ne.tagList)}`,name:"tagList",children:(0,n.jsx)(l.Z,{placeholder:"Tag1, Tag2, Tag3..."})}),(0,n.jsx)(o.Z.Item,{initialValue:fe,label:"Sub Document List View Type:",name:"subDocumentListViewType",children:(0,n.jsxs)(s.Z,{children:[(0,n.jsx)(te,{value:I.lm.header,children:"Header"}),(0,n.jsx)(te,{value:I.lm.headerImage,children:"Header-Image"})]})}),(0,n.jsx)(o.Z.Item,{initialValue:he,label:"Sub Document List:",name:"subDocumentIdList",children:(0,n.jsx)(s.Z,{disabled:0===$e.length,filterOption:!0,loading:0===$e.length,mode:"multiple",optionFilterProp:"title",placeholder:"Sub Document Id...",children:$e.map(z)})}),(0,n.jsx)(C,{mdInput:Ne.content,children:(0,n.jsx)(o.Z.Item,{initialValue:L,label:"Content, use markdown:",name:"content",children:(0,n.jsx)(ie,{placeholder:"# Markdown...",rows:10})})}),(0,n.jsx)(C,{mdInput:Ne.description,children:(0,n.jsx)(o.Z.Item,{initialValue:k,label:"Description, use markdown:",name:"description",children:(0,n.jsx)(ie,{placeholder:"Some description is here...",rows:3})})}),(0,n.jsx)(o.Z.Item,{initialValue:N,label:"Short description, plain text only, used for Open Graph:",name:"descriptionShort",children:(0,n.jsx)(ie,{placeholder:"Some short description is here...",rows:3})}),(0,n.jsx)(o.Z.Item,{label:`Files (image to 16MB, other to 75MB): ${Le.length}`,children:(0,n.jsx)(c.Z,{action:async e=>{try{Ce(!0);const t=(0,P.D6)(e.name)?X.$t:X.WY,i=await(0,P.cT)(e,t);ye((e=>[...e,i]))}catch(e){const t=e instanceof Error?e.message:"Too big file";d.ZP.error(t)}finally{Ce(!1)}return"https://dev.null/dev/null"},fileList:Le.map(B),itemRender:(e,t)=>{const i=Le.find((e=>e.name===t.name));return G({file:t,fileInfo:i,originNode:e,setFileTitle:e=>{i&&(i.title=e,ye([...Le]))}})},listType:"picture",onChange:function(e){const{file:t}=e;"removed"===t.status&&ye((e=>e.filter((e=>e.name!==t.name))))},children:(0,n.jsx)(J,{})})}),(0,n.jsx)(o.Z.Item,{initialValue:b().utc(we),label:"Publish date UTC-0:",name:"publishDate",children:(0,n.jsx)(u.Z,{onOk:e=>Te(e.toISOString()),showTime:!0})}),(0,n.jsx)(o.Z.Item,{initialValue:y||X.hd,label:"Created date UTC-0:",name:"createdDate",children:(0,n.jsx)(l.Z,{disabled:!0})}),(0,n.jsx)(o.Z.Item,{initialValue:Ze||X.hd,label:"Updated date UTC-0:",name:"updatedDate",children:(0,n.jsx)(l.Z,{disabled:!0})}),(0,n.jsx)(m.Z,{orientation:"center",children:"SEO"}),(0,n.jsx)(o.Z.Item,{initialValue:xe,label:"Meta Title, tag <title>...</title>:",name:"tagTitleSeo",children:(0,n.jsx)(l.Z,{placeholder:"Title..."})}),(0,n.jsx)(o.Z.Item,{initialValue:U,label:"Has Meta Robots No Follow:",name:"hasMetaRobotsNoFollowSeo",valuePropName:"checked",children:(0,n.jsx)(h.Z,{children:'Add/combine <meta name="robots" content="nofollow" />'})}),(0,n.jsx)(o.Z.Item,{initialValue:O,label:"Has Meta Robots No Index:",name:"hasMetaRobotsNoIndexSeo",valuePropName:"checked",children:(0,n.jsx)(h.Z,{children:'Add/combine <meta name="robots" content="noindex"/> and add X-Robots-Tag: noindex'})}),(0,n.jsx)(o.Z.Item,{initialValue:H,label:"Is Active:",name:"isActive",valuePropName:"checked",children:(0,n.jsx)(h.Z,{children:'Uncheck to temporary "remove" (also remove from sitemap.xml)'})}),(0,n.jsx)(o.Z.Item,{initialValue:Q,label:"Is In Site Map Xml:",name:"isInSiteMapXmlSeo",valuePropName:"checked",children:(0,n.jsx)(h.Z,{children:"Does sitemap.xml has link to article or not"})}),(0,n.jsx)(o.Z.Item,{initialValue:_,label:'Meta Description, tag <meta name="description" content="..." />:',name:"metaDescriptionSeo",children:(0,n.jsx)(l.Z,{placeholder:"Description..."})}),(0,n.jsx)(o.Z.Item,{initialValue:ne,label:'Meta KeyWords, tag <meta name="keywords" content="..." />:',name:"metaKeyWordsSeo",children:(0,n.jsx)(l.Z,{placeholder:"KeyWords..."})}),(0,n.jsx)(o.Z.Item,{initialValue:ae,label:"Meta, actually any valid html code:",name:"metaSeo",rules:(0,P.sB)(),children:(0,n.jsx)(ie,{placeholder:"Additional meta tags...",rows:3})}),(0,n.jsx)(m.Z,{orientation:"center",children:"Staff"}),(0,n.jsx)(o.Z.Item,{initialValue:(0,w.sj)(le),label:`Staff Artists, use comma "," to divide: ${(0,w.pi)(Ne.staffArtistList)}`,name:"staffArtistList",children:(0,n.jsx)(l.Z,{placeholder:"Name1, Name2, Name3..."})}),(0,n.jsx)(o.Z.Item,{initialValue:(0,w.sj)(oe),label:`Staff Authors, use comma "," to divide: ${(0,w.pi)(Ne.staffAuthorList)}`,name:"staffAuthorList",children:(0,n.jsx)(l.Z,{placeholder:"Name1, Name2, Name3..."})}),(0,n.jsx)(o.Z.Item,{initialValue:(0,w.sj)(de),label:`Staff Compositors, use comma "," to divide: ${(0,w.pi)(Ne.staffCompositorList)}`,name:"staffCompositorList",children:(0,n.jsx)(l.Z,{placeholder:"Name1, Name2, Name3..."})}),(0,n.jsx)(o.Z.Item,{initialValue:(0,w.sj)(ce),label:`Staff Directors, use comma "," to divide: ${(0,w.pi)(Ne.staffDirectorList)}`,name:"staffDirectorList",children:(0,n.jsx)(l.Z,{placeholder:"Name1, Name2, Name3..."})}),(0,n.jsx)(o.Z.Item,{initialValue:(0,w.sj)(ue),label:`Staff Illustrators, use comma "," to divide: ${(0,w.pi)(Ne.staffIllustratorList)}`,name:"staffIllustratorList",children:(0,n.jsx)(l.Z,{placeholder:"Name1, Name2, Name3..."})}),(0,n.jsx)(o.Z.Item,{initialValue:(0,w.sj)(me),label:`Staff Readers, use comma "," to divide: ${(0,w.pi)(Ne.staffReaderList)}`,name:"staffReaderList",children:(0,n.jsx)(l.Z,{placeholder:"Name1, Name2, Name3..."})}),(0,n.jsxs)(o.Z.Item,{children:[(0,n.jsx)(f.Z,{htmlType:"submit",type:"primary",children:"Submit (ctrl+S)"}),(0,n.jsxs)(V.K,{isRender:r===X.dW.edit,children:[" ",(0,n.jsx)(p.Z,{cancelText:"No",disabled:Ee,icon:(0,n.jsx)(j.Z,{style:{color:g.Q6.primary}}),okText:"Delete",onConfirm:()=>(0,P.kA)(W),title:"Are you sure to delete the article？",children:(0,n.jsx)(f.Z,{disabled:Ee,htmlType:"button",type:"default",children:Ee?"Can NOT delete, article has parent":"Delete"})})]})]})]})}},2137:(e,t,i)=>{i.d(t,{Q:()=>u});var n=i(5893),a=i(7183),r=i(6578),s=i(9250),l=i(9655),o=(i(8257),i(7687)),d=i(4057);const{Content:c}=a.Z;function u(e){const{children:t}=e,i=(0,s.TH)();return(0,n.jsxs)(a.Z,{children:[(0,n.jsx)(o.x,{padding:16,children:(0,n.jsx)(r.Z,{defaultSelectedKeys:[i.pathname],items:[{key:d.$.articleList.path,label:(0,n.jsx)(l.Link,{to:d.$.articleList.path,children:"List"})},{key:d.$.articleCreate.path,label:(0,n.jsx)(l.Link,{to:d.$.articleCreate.path,children:"Create"})},{key:d.$.articleTree.path,label:(0,n.jsx)(l.Link,{to:d.$.articleTree.path,children:"Tree"})}],mode:"horizontal"})}),(0,n.jsx)(o.x,{padding:16,children:(0,n.jsx)(c,{children:t})})]})}}}]);
//# sourceMappingURL=225.8acb86.chunk.js.map